/*
+--------------------+
| Rodrigo CavanhaMan |
|        IFTM        |
|        SSI         |
+--------------------+
*/
import java.util.Locale;
import java.util.Scanner;

public class Decripta {

	public static void main(String[] args) {
		Scanner sc = new Scanner(System.in);
		sc.useLocale(Locale.ENGLISH);
		Locale.setDefault(new Locale("en", "US"));
		
		Decripta strToHex = new Decripta();
		String hex = "4e65766572206665617220436176616e6861206973206865726521";
		//String hex = "1217181E08011A051606100E020207030B1E1C09040E0F06011B070C09001C0D0B011A1E1E0A090500131808031B0B020D061000021C0117011716081F1C010105020708030B0F090B010408080E180D0013050C1E1C0F010A131A081E1B0F090B011108000E0117011C190C0E0E0A0517171B010C0C0B090B01141E000E011700170502041C1E010A011000021C0D160D131B0E0C1C0F00011E010C1E1E0B0105041C090C1F0F17171310030C00080D07131B0C090E0A010D0A1408030A00070500100A1F0A1D17050414041D0E1C05011F180C1F020B0D101D190203080B140500140C021F0B000B14140902020F0D171E1A030A0A1F01011D0609080A1D011716101E08010205071718021E0E1D09051D061D021D1F01011C14021B0E0201050210030C0C0F0A17130700020101171517101F0A001401091D061C080A1C0A051D1202170A030B1702141E1E0E030B17111A0002001C0D0B1F14041E190F080101140F081D1E051701141F1E0602010A111C021E0E03010A0610081E0A03000101141E1E001D1701151A1E0A1D0F0A0017061E08020F090B00101E030A030B001B1A1E030A0314051B0D02081C1F01011E101B0C011A050913030217010B090D1C0308070E1D150117110C020201120D1F100319000A0109131C1E0C001D0B081A1A1E030A0307011B110C09001D140B000408081C0B0B17061C1B081C1D010B001C021E0A0314161716021F1D0B160D13101E08021E16011B07040C1B0B16051D180C1F0E0301091D1B021E1B1C050A031004010E03010A06101D08011D050A161A1C080A1E0B001B1400021C1D0115171C1E081C1D01091D06191F000D051610100407001D010510070C0E001D01071307040E060F170913061C080A03050D01030C010A0B1710130700021C1D010A061409021C0F0B141710000900010110001A020819070A001D16021F1D0B160B001C0208190B0A001D1A0E02030605091D060B01001C011702100A0C1B0B0A011E141E080B0B0D1C13141E03000D0B081D101C080A0117011705081F090B090101100C1B0614010B1F1A0008011A0B01010108000003010A061A08001E0B01171D061E08080F00051F1003190A00050B11070800001D01091C14090C1F0F03051D060403000D010A06101E090E0A0107131108030C0705051D180803001D1701141A1F1E00030616131403190A1D08011F171F0C1D1A01050111080006030001021A041E1C0B091517100C0006000C051E10000F1D0F0A071301080C1D0A050B1701080B061C050B17010800001805141D071C080A00010A11140803030F07051F1A1E0C1C03050B011B080001011706171C070C0201170A17180B0202011709131C1E09001F01011107040C010D05171706080C011A0117161A1C080A0B010817030C1F0A1D0B0B101A01020E01060500040808061C0B171D180F1F060101011C14090C1B0B16011B0408081C01021617070C02030B090600141F000A0A01101B06081F020B051701100C1B0A0F09011F1A1F040E02010910070C030B01100113061E04020F06011B070C1F060114051514191F061D10011716020009020B16170603021D0B0305111A";
		System.out.println("Mensagem original: " + hex);
		System.out.println("ASCII : " + strToHex.convertHexToString(hex));
		
		System.out.println(aplicaChaveTexto(hex));
		
		sc.close();
	}
	
	public static String aplicaChaveTexto (String mensagemCifrada){
		int textoSize = mensagemCifrada.length();
		char teste[]={'s','o','s','s','e','g','o'};
		char mensagemResgatada[] = new char[textoSize];
		for(int i=0 ; i<textoSize ; i++) {
	        mensagemResgatada[i]=mensagemCifrada[i]^teste[i%6];
	        if((mensagemResgatada[i]>64 && mensagemResgatada[i]<91) || (mensagemResgatada[i]>96 && mensagemResgatada[i]<123))
	        	System.out.println("%c ",mensagemResgatada[i]);
			else
				System.out.println("%02X ",mensagemResgatada[i]);
		}
		return "";
	}
	
	public String convertHexToString(String hex){
		StringBuilder sb = new StringBuilder();
		StringBuilder temp = new StringBuilder();
		  
		//49204c6f7665204a617661 split into two characters 49, 20, 4c...
		for( int i=0; i<hex.length()-1; i+=2 ){
			//Separa os pares
			String output = hex.substring(i, (i + 2));
			//converte hex para decimal
			int decimal = Integer.parseInt(output, 16);
			//convert decimal para charactere
			if ((decimal >= 65 && decimal <= 90) || (decimal >= 97 && decimal <= 122) ) {
				sb.append((char)decimal);
				temp.append(decimal);
			}
			else {
				sb.append((char)0);
				temp.append(0);
			}
		}
		System.out.println("Saida em decimal: " + temp.toString());
		  
		return sb.toString();
	}
}